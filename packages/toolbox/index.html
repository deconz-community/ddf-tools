<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="apple-touch-icon" href="/pwa-192x192.png">
    <meta name="msapplication-TileColor" content="#00aba9">
    <title>Deconz Toolbox</title>
  </head>
  <body>
    <div id="app"></div>
    <script>
      setTimeout(() => {
        const app = document.getElementById('app')
        if(app.hasAttribute('data-v-app')) return
        app.innerHTML = `
          <h1>Deconz Toolbox</h1>
          <p>
            If you see this page, it means that you have a browser cache issue.
            Please clear your browser cache and try again.
          </p>
        `
      }, 2000)
    </script>
    <script>
      // From https://github.com/vuejs/router/issues/2054#issuecomment-2136520198
      // This script merges query parameters into the hash part of the URL for the Vue Router to work properly
      ;(function () {
        const location = window.location
        let path = location.pathname
        let searchParams = new URLSearchParams(location.search)
        let hash = location.hash

        // Check if there is a hash and query parameters
        if (hash && location.search) {
          const hashParts = hash.split('?')
          const hashBase = hashParts[0]
          let hashParams = new URLSearchParams(hashParts[1])

          // Merge the parameters
          searchParams.forEach((value, key) => {
            hashParams.set(key, value)
          })

          // Create a new URL with merged parameters
          const newHash = `${hashBase}?${hashParams.toString()}`
          const newUrl = `${path}${newHash}`

          // Redirect to the new URL if it's different from the current one
          if (newUrl !== location.href) {
            window.location.replace(newUrl)
          }
        }
      })()
    </script>
    <script type="module" src="/src/main.ts"></script>
    <noscript>
      This website requires JavaScript to function properly. Please enable
      JavaScript to continue.
    </noscript>
  </body>
</html>